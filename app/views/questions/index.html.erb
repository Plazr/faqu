<h1>Listing questions</h1>

<%= link_to ' Home ', "/" %>
</br>
<% if (admin) %>
        <%= link_to ' New Question ', new_question_path %>
    <% end %>
    
</br>
<table>
  <tr>
    <% if (!admin) %>
      <%= form_tag questions_path, :method => 'get' do %>
        
        <%#= collection_select :search, nil, @categories, :id, :description,{:include_blank => "All"}  %>
        <%= select_tag "search", options_for_select(["All"]+@categories.map{|a| [a.description,a.id]},params[:search]),{:onchange => 'this.form.submit()'}%>
        
      <% end

      <%= form_for('search') do |t| %>
        <%= t.select :category_id, Category.all.collect{|p| [p.description,p.id]} %>
        <%= t.submit :filter %>  
      <% end %>

     end %>
    </br>
    <h2> <%= "Categoria : " + @search_category if @search_category  %></h2>

   
    <% if admin %>
      <th>Category</th>
    <% end %>

    <th>Question</th>

    <th></th>
    <th></th>
    <th></th>
  </tr>

<% @questions.each do |question| %>
  <tr>
    
    <% if (admin) %>
          <td><%= question.category_id %></td>
    <% end %>

    <td><%= link_to question.question, question  %></td>

  </tr>
<% end %>
</table>

<br />

    <% if admin %>
        <%= link_to 'New Question', new_question_path %><br/>
        <%= link_to 'Manage Categories', categories_path %>
    <% end %>

